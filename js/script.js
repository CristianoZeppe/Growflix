// ======================================================
// COMPLETE ARRAY OF VIDEOS (25 ITEMS)
// ======================================================
const movies = [
   // ====================== "GROWCAST" =====================
   {
      img: "https://i.ytimg.com/vi/aJ-HZuLcKeA/maxresdefault.jpg",
      title: "Growcast #00 - Conheça a Growdev",
      link: "https://www.youtube.com/embed/aJ-HZuLcKeA",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/7OWT3lfHYvE/maxresdefault.jpg",
      title: "Growcast #01 - As profissões do futuro",
      link: "https://www.youtube.com/embed/7OWT3lfHYvE",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/ci1eQGPK89o/maxresdefault.jpg",
      title: "Growcast #02 - Como seguir a carreira internacional?",
      link: "https://www.youtube.com/embed/ci1eQGPK89o",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/WM7pGG7OicQ/maxresdefault.jpg",
      title: "Growcast #03 - Superando os desafios da carreira de dev",
      link: "https://www.youtube.com/embed/WM7pGG7OicQ",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/2c8VOBZ160Y/maxresdefault.jpg",
      title: "Growcast #04 - Agile Master: tudo sobre a profissão",
      link: "https://www.youtube.com/embed/2c8VOBZ160Y",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/mxnEm03cYPc/maxresdefault.jpg",
      title: "Growcast #05 - Como iniciar na carreira em desenvolvimento de softwares?",
      link: "https://www.youtube.com/embed/mxnEm03cYPc",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/m7DyR07KrOE/maxresdefault.jpg",
      title: "Growcast #06 - Mulheres e inclusão na tecnologia",
      link: "https://www.youtube.com/embed/m7DyR07KrOE",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/vW8G9KPwRL0/maxresdefault.jpg",
      title: "Growcast #07 - Desenvolvendo profissionais na área de TI",
      link: "https://www.youtube.com/embed/vW8G9KPwRL0",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/_Ut2KqAqPyk/maxresdefault.jpg",
      title: "Growcast #08 - A solução que está transformando o mercado de TI no Brasil",
      link: "https://www.youtube.com/embed/_Ut2KqAqPyk",
      category: "Growcast",
   },
   {
      img: "https://i.ytimg.com/vi/dfDgs0Ive2Q/maxresdefault.jpg",
      title: " Growcast #09 - Tudo sobre o mercado de trabalho no mundo da TI",
      link: "https://www.youtube.com/embed/dfDgs0Ive2Q",
      category: "Growcast",
   },

   // ====================== "WEBINAR" ======================
   {
      img: "https://i.ytimg.com/vi/WKbLXuP9S-c/maxresdefault.jpg",
      title: "Webinar - Recriando a interface do Linkedin com Flutter",
      link: "https://www.youtube.com/embed/WKbLXuP9S-c",
      category: "Webinar com Flutter",
   },
   {
      img: "https://i.ytimg.com/vi/dJ6y1zMjVXU/maxresdefault.jpg",
      title: "Webinar - Recriando a interface do Instagram com Flutter",
      link: "https://www.youtube.com/embed/dJ6y1zMjVXU",
      category: "Webinar com Flutter",
   },
   {
      img: "https://i.ytimg.com/vi/8rdJsqUjsGg/maxresdefault.jpg",
      title: "Webinar - Recriando a interface do iFood com Flutter",
      link: "https://www.youtube.com/embed/8rdJsqUjsGg",
      category: "Webinar com Flutter",
   },
   {
      img: "https://i.ytimg.com/vi/C4p_7qBsECw/maxresdefault.jpg",
      title: "Webinar - Recriando a interface do PicPay com Flutter",
      link: "https://www.youtube.com/embed/C4p_7qBsECw",
      category: "Webinar com Flutter",
   },
   {
      img: "https://i.ytimg.com/vi/L1pKoMC6hWk/maxresdefault.jpg",
      title: "Webinar - Recriando o layout do WhatsApp com Flutter",
      link: "https://www.youtube.com/embed/L1pKoMC6hWk",
      category: "Webinar com Flutter",
   },

   // ====================== "UX/UI" ======================
   {
      img: "https://i.ytimg.com/vi/-26aqPtgoEY/maxresdefault.jpg",
      title: "Live #01 Jornada UX/UI: UX/UI design no desenvolvimento de produto digital",
      link: "https://www.youtube.com/embed/26aqPtgoEY",
      category: "Jornada UX/UI",
   },
   {
      img: "https://i.ytimg.com/vi/8sd3wuKTZMA/maxresdefault.jpg",
      title: "Live #02 Jornada UX/UI: Profissional de UX/UI design no mercado digital",
      link: "https://www.youtube.com/embed/8sd3wuKTZMA",
      category: "Jornada UX/UI",
   },
   {
      img: "https://i.ytimg.com/vi/ZMZjQ9aRuIY/maxresdefault.jpg",
      title: "Live #03 Jornada UX/UI: Oportunidades de estudar um programa de formação",
      link: "https://www.youtube.com/embed/ZMZjQ9aRuIY",
      category: "Jornada UX/UI",
   },
   {
      img: "https://i.ytimg.com/vi/cwqDu0ZzbYE/maxresdefault.jpg",
      title: "Live #04 Jornada UX/UI: A trajetória de uma designer-Growdev",
      link: "https://www.youtube.com/embed/cwqDu0ZzbYE",
      category: "Jornada UX/UI",
   },
   {
      img: "https://i.ytimg.com/vi/FiZMowbaiJA/maxresdefault.jpg",
      title: "Live #05 Jornada UX/UI: Design é para todos?",
      link: "https://www.youtube.com/embed/FiZMowbaiJA",
      category: "Jornada UX/UI",
   },

   // ====================== "DIVERSOS" ======================
   {
      img: "https://i.ytimg.com/vi/QsuhYgsSYQo/maxresdefault.jpg",
      title: "Célula de talentos - solução Growdev",
      link: "https://www.youtube.com/embed/QsuhYgsSYQo",
      category: "Diversos",
   },
   {
      img: "https://i.ytimg.com/vi/ouDn8z3PSqs/maxresdefault.jpg",
      title: "Como é o dia a dia de um dev",
      link: "https://www.youtube.com/embed/ouDn8z3PSqs",
      category: "Diversos",
   },
   {
      img: "https://i.ytimg.com/vi/cQDQNX6NXYo/maxresdefault.jpg",
      title: "Onde trabalhar com qualidade de software?",
      link: "https://www.youtube.com/embed/cQDQNX6NXYo",
      category: "Diversos",
   },
   {
      img: "https://i.ytimg.com/vi/nKGbolkirBM/sddefault.jpg",
      title: "Webinar analista de dados",
      link: "https://www.youtube.com/embed/nKGbolkirBM",
      category: "Diversos",
   },
   {
      img: "https://i.ytimg.com/vi/6sZPsqNjeek/maxresdefault.jpg",
      title: "Tecnologia trazendo soluções para Arezzo",
      link: "https://www.youtube.com/embed/6sZPsqNjeek",
      category: "Diversos",
   },
];

// ======================================================
// FUNCTION TO OPEN VIDEO IN OVERLAY
// ======================================================
function openVideo(videoLink, onClose) {
   // create overlay container
   const overlay = document.createElement("div");
   overlay.classList.add("overlay");

   // disable scroll on the main page
   document.documentElement.classList.add("no-scroll");

   // create top bar with close button
   const topBar = document.createElement("div");
   topBar.classList.add("top-bar");

   const closeBtn = document.createElement("button");
   closeBtn.textContent = "✕";
   closeBtn.classList.add("close-btn");

   topBar.appendChild(closeBtn);
   overlay.appendChild(topBar);

   // create container for iframe
   const iframeContainer = document.createElement("div");
   iframeContainer.classList.add("iframe-container");

   const iframe = document.createElement("iframe");
   iframe.classList.add("player-iframe");
   iframe.src = videoLink + "?autoplay=1";
   iframe.allowFullscreen = true;

   iframeContainer.appendChild(iframe);
   overlay.appendChild(iframeContainer);
   document.body.appendChild(overlay);

   // close overlay when clicking outside the iframe
   overlay.addEventListener("click", (e) => {
      if (!iframe.contains(e.target)) {
         closeOverlay();
      }
   });

   function closeOverlay() {
      if (overlay.parentNode) {
         document.body.removeChild(overlay);
         document.documentElement.classList.remove("no-scroll");
         if (onClose) onClose();
      }
   }

   closeBtn.addEventListener("click", closeOverlay);
}

// ======================================================
// FUNCTION TO DISPLAY VIDEO THUMBNAILS
// ======================================================
function videosSection(categories, containerId, customTitle) {
   const section = document.getElementById(containerId);
   if (!section) return;

   section.innerHTML = "";

   const container = document.createElement("div");
   container.classList.add("container");

   // create section title
   const rowTitle = document.createElement("div");
   rowTitle.classList.add("row");

   const colTitle = document.createElement("div");
   colTitle.classList.add("col-12");

   const title = document.createElement("h2");
   title.classList.add("title");

   const titleLink = document.createElement("a");
   titleLink.textContent = customTitle;
   titleLink.href = `#${containerId}`;
   titleLink.classList.add("section-titles", "text-decoration-none");

   title.appendChild(titleLink);

   // add play icon to title
   const icon = document.createElement("span");
   icon.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" width="27" height="30" fill="currentColor" viewBox="0 0 17 17">
            <path d="M6 4.5v7l6-3.5-6-3.5z"/>
        </svg>
    `;

   colTitle.appendChild(title);
   rowTitle.appendChild(colTitle);
   container.appendChild(rowTitle);
   titleLink.appendChild(icon);

   const row = document.createElement("div");
   row.classList.add("row", "gy");

   // filter videos by category
   const filteredVideos = movies.filter(
      (video) => video.category === categories,
   );

   filteredVideos.forEach((video) => {
      const col = document.createElement("div");
      col.classList.add(
         "col-12",
         "col-md-6",
         "col-lg-4",
         "col-xl-3",
         "video-card",
      );

      // exception for video with black bars (thumbnail smaller than usual)
      if (video.link.includes("nKGbolkirBM")) {
         col.classList.add("video-exception");
      }

      // create video thumbnail
      const img = document.createElement("img");
      img.src = video.img;
      img.classList.add("ms-3.5", "mx-md-0");

      // create bottom info container with title and play icon
      const videoTitle = document.createElement("h6");
      videoTitle.textContent = video.title;
      videoTitle.classList.add("video-title", "play-pointer");

      const playIcon = document.createElement("img");
      playIcon.src = "assets/libs/Bootstrap-5.3.8/icons/play-circle.svg";
      playIcon.classList.add("play-inline", "play-pointer");

      const videoInfo = document.createElement("div");
      videoInfo.appendChild(videoTitle);
      videoTitle.prepend(playIcon);

      // clicking on bottom bar opens the video overlay
      videoInfo.addEventListener("click", (e) => {
         e.stopPropagation();
         openVideo(video.link);
      });

      col.appendChild(img);
      col.appendChild(videoInfo);
      row.appendChild(col);
   });

   container.appendChild(row);
   section.appendChild(container);
}

// ======================================================
// SLIDER FUNCTION FOR HERO IMAGES
// ======================================================
function slider(containerId) {
   const ctaBtn = document.getElementById("cta-btn");
   const container = document.getElementById(containerId);
   if (!container || !ctaBtn) return;

   // select only specific videos for the slider
   const heroImages = movies.filter(
      (video) =>
         video.title === "Growcast #01 - As profissões do futuro" ||
         video.title ===
            "Growcast #02 - Como seguir a carreira internacional?" ||
         video.title ===
            "Growcast #04 - Agile Master: tudo sobre a profissão" ||
         video.title ===
            "Growcast #05 - Como iniciar na carreira em desenvolvimento de softwares?" ||
         video.title ===
            "Growcast #08 - A solução que está transformando o mercado de TI no Brasil" ||
         video.title ===
            " Growcast #09 - Tudo sobre o mercado de trabalho no mundo da TI",
   );

   let currentIndex = 0;
   let currentImageElement = null;
   let currentImageData = null;
   let sliderInterval = null;

   function showImage() {
      if (heroImages.length === 0) return;

      const imageData = heroImages[currentIndex];

      const newImg = document.createElement("img");
      newImg.src = imageData.img;
      newImg.classList.add("fade-img");

      container.appendChild(newImg);

      setTimeout(() => {
         newImg.classList.add("show");
      }, 100);

      const oldImage = currentImageElement;

      currentImageElement = newImg;
      currentImageData = imageData;

      if (oldImage) {
         oldImage.classList.add("fade-out");
         oldImage.classList.remove("show");

         setTimeout(() => {
            oldImage.remove();
         }, 1000);
      }

      currentIndex = (currentIndex + 1) % heroImages.length;
   }

   function startSlider() {
      if (sliderInterval) clearInterval(sliderInterval);
      sliderInterval = setInterval(showImage, 5000);
   }

   function pauseSlider() {
      if (sliderInterval) {
         clearInterval(sliderInterval);
         sliderInterval = null;
      }
   }

   // open video when clicking on the CTA button
   ctaBtn.addEventListener("click", function (e) {
      e.preventDefault();
      if (!currentImageData) return;

      pauseSlider();

      openVideo(currentImageData.link, function () {
         startSlider();
      });
   });

   showImage();
   startSlider();
}

// ======================================================
// FUNCTION CALLS
// ======================================================
videosSection("Growcast", "Growcast", "Growcast [Episódios]");
videosSection("Webinar com Flutter", "Flutter", "Webinar em Flutter");
videosSection("Jornada UX/UI", "UXUI", "Jornada UX/UI");
videosSection("Diversos", "Diversos", "Diversos");
slider("slider");

// ======================================================
// MOBILE MENU ZOOM EFFECT
// ======================================================
const bgHome = document.querySelector(".bg-home");
const menu = document.querySelector("#mobileMenu");

// zoom background when menu opens
menu.addEventListener("show.bs.collapse", function () {
   bgHome.classList.add("zoom");
});

// remove zoom when menu closes
menu.addEventListener("hide.bs.collapse", function () {
   bgHome.classList.remove("zoom");
});
